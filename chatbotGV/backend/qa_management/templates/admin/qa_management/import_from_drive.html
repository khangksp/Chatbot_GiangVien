{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block title %}Import & Hot Reload | Django Admin{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">Trang ch·ªß</a>
    &rsaquo; <a href="{% url 'admin:qa_management_qaentry_changelist' %}">Q&A Entries</a>
    &rsaquo; Import & Hot Reload
</div>
{% endblock %}

{% block content %}
<div class="module aligned" style="max-width: 800px;">
    <h1>üöÄ Import & Hot Reload t·ª´ Drive</h1>
    
    <div class="form-row" style="margin: 20px 0; padding: 15px; background: #f8f9fa; border-left: 4px solid #17a2b8;">
        <h3 style="color: #17a2b8; margin-top: 0;">‚ÑπÔ∏è Quy tr√¨nh x·ª≠ l√Ω</h3>
        <ul style="margin: 0; line-height: 1.6;">
            <li><strong>1. Sync Disk:</strong> T·∫£i file <code>QA.csv</code> m·ªõi nh·∫•t t·ª´ Google Drive v·ªÅ Database.</li>
            <li><strong>2. C·∫≠p nh·∫≠t DB:</strong> T·∫°o m·ªõi ho·∫∑c c·∫≠p nh·∫≠t c√°c c√¢u h·ªèi d·ª±a tr√™n STT.</li>
            <li><strong>3. üî• Hot Reload:</strong> X√≥a b·ªô nh·ªõ c≈© v√† n·∫°p d·ªØ li·ªáu m·ªõi v√†o RAM c·ªßa Chatbot ngay l·∫≠p t·ª©c.</li>
        </ul>
    </div>
    
    <div class="form-row" style="margin: 20px 0; padding: 15px; background: #fff3cd; border-left: 4px solid #ffc107;">
        <h3 style="color: #856404; margin-top: 0;">‚ö†Ô∏è L∆∞u √Ω</h3>
        <ul style="margin: 0; color: #856404;">
            <li>H√†nh ƒë·ªông n√†y s·∫Ω c·∫≠p nh·∫≠t ki·∫øn th·ª©c cho Chatbot <strong>ngay l·∫≠p t·ª©c</strong>.</li>
            <li>Kh√¥ng c·∫ßn kh·ªüi ƒë·ªông l·∫°i (Restart) Server.</li>
            <li>ƒê·∫£m b·∫£o b·∫°n ƒë√£ l∆∞u file tr√™n Google Drive tr∆∞·ªõc khi b·∫•m n√∫t.</li>
        </ul>
    </div>
    
    <form method="post" style="margin-top: 30px;">
        {% csrf_token %}
        
        <div class="form-row">
            <div class="field-box">
                <h2>X√°c nh·∫≠n h√†nh ƒë·ªông</h2>
                <p>B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën t·∫£i d·ªØ li·ªáu v√† l√†m m·ªõi b·ªô nh·ªõ AI kh√¥ng?</p>
                
                <div style="margin: 20px 0;">
                    <label>
                        <input type="checkbox" id="confirm_import" required>
                        T√¥i hi·ªÉu v√† mu·ªën th·ª±c hi·ªán Hot Reload
                    </label>
                </div>
                
                <div style="margin: 20px 0;">
                    <label>
                        <input type="checkbox" id="create_backup" checked>
                        T·∫°o backup d·ªØ li·ªáu hi·ªán t·∫°i (Khuy·∫øn ngh·ªã)
                    </label>
                </div>
            </div>
        </div>
        
        <div class="submit-row">
            <input type="submit" value="üöÄ CH·∫†Y IMPORT & RELOAD NGAY" class="default" 
                   onclick="return confirm('H·ªá th·ªëng s·∫Ω t·∫£i d·ªØ li·ªáu v√† n·∫°p l·∫°i b·ªô nh·ªõ AI. Ti·∫øp t·ª•c?');">
            <a href="../tools/" class="button cancel-link">
                Quay l·∫°i
            </a>
        </div>
    </form>
    
    <div class="form-row" style="margin-top: 30px; padding: 15px; background: #d4edda; border-left: 4px solid #28a745;">
        <h3 style="color: #155724; margin-top: 0;">üí° Tr·∫°ng th√°i</h3>
        <p style="margin: 0; color: #155724;">
            Sau khi qu√° tr√¨nh ho√†n t·∫•t (kho·∫£ng 3-5 gi√¢y), Chatbot s·∫Ω tr·∫£ l·ªùi ƒë∆∞·ª£c ngay c√°c c√¢u h·ªèi m·ªõi.
        </p>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const confirmCheckbox = document.getElementById('confirm_import');
    const submitButton = document.querySelector('input[type="submit"]');
    
    // Disable n√∫t submit ban ƒë·∫ßu
    submitButton.disabled = true;
    submitButton.style.opacity = '0.5';
    
    confirmCheckbox.addEventListener('change', function() {
        submitButton.disabled = !this.checked;
        if (this.checked) {
            submitButton.style.opacity = '1';
            submitButton.style.cursor = 'pointer';
        } else {
            submitButton.style.opacity = '0.5';
            submitButton.style.cursor = 'not-allowed';
        }
    });

    // Hi·ªáu ·ª©ng loading khi b·∫•m n√∫t
    document.querySelector('form').addEventListener('submit', function() {
        if (submitButton.disabled === false) {
            submitButton.value = "‚è≥ ƒêang x·ª≠ l√Ω (Vui l√≤ng ƒë·ª£i)...";
            submitButton.style.opacity = '0.8';
        }
    });
});
</script>
{% endblock %}